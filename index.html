<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ST.ABANOUB.CHURCH</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Amiri&family=Tajawal:wght@700&display=swap');
  body { font-family: 'Tajawal', sans-serif; }
</style>
</head>
<body class="bg-gray-900 text-white flex flex-col items-center min-h-screen py-8">

<h1 class="text-3xl font-bold mb-4">âœ¨ Ø£ÙŠÙ‡ ÙƒÙ„ ÙŠÙˆÙ… âœï¸ âœ¨</h1>

<!-- Canvas -->
<canvas id="canvas" class="border-4 border-yellow-400 rounded-2xl mb-6 bg-gray-800 w-11/12 md:w-2/3 lg:w-1/2"></canvas>

<!-- Ø§Ù„ØªØ­ÙƒÙ… -->
<div class="w-11/12 md:w-2/3 lg:w-1/2 bg-gray-800 p-4 rounded-2xl space-y-4 shadow-lg">
  
  <!-- Ø§Ù„ØµÙˆØ±Ø© -->
  <div>
    <label class="block mb-1 text-gray-300 font-semibold">ğŸ“· Ø§Ø®ØªØ± ØµÙˆØ±Ø©:</label>
    <input type="file" id="imageInput" accept="image/*"
      class="block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-md
             file:border-0 file:text-sm file:font-semibold file:bg-yellow-500 file:text-gray-900 hover:file:bg-yellow-400">
  </div>

  <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†ØµÙˆØµ -->
  <div id="textsContainer" class="space-y-4"></div>

  <!-- Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ù†Øµ -->
  <button id="addTextBtn"
    class="w-full py-2 bg-yellow-500 hover:bg-yellow-400 text-black text-lg font-semibold rounded-lg">
    â• Ø¥Ø¶Ø§ÙØ© Ù†Øµ Ø¬Ø¯ÙŠØ¯
  </button>

  <!-- ØªØ­Ù…ÙŠÙ„ -->
  <button id="downloadBtn"
    class="w-full py-2 bg-green-500 hover:bg-green-400 text-white text-lg font-semibold rounded-lg">
    â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
  </button>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const img = new Image();
const imageInput = document.getElementById('imageInput');
const textsContainer = document.getElementById('textsContainer');
const addTextBtn = document.getElementById('addTextBtn');
let texts = []; // ÙƒÙ„ Ø§Ù„Ù†ØµÙˆØµ

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
imageInput.addEventListener('change', e=>{
  const file=e.target.files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=ev=>{
    img.onload=()=>{
      canvas.width=img.width;
      canvas.height=img.height;
      draw();
    };
    img.src=ev.target.result;
  };
  reader.readAsDataURL(file);
});

// Ø¥Ø¶Ø§ÙØ© Ù†Øµ Ø¬Ø¯ÙŠØ¯
addTextBtn.addEventListener('click', ()=>{
  const id = Date.now();
  const textObj = {
    id,
    text: "Ù†Øµ Ø¬Ø¯ÙŠØ¯",
    fillColor: "#ffffff",
    strokeColor: "#d4af37",
    strokeWidth: 8,
    fontSize: 80,
    x: canvas.width / 2 || 250,
    y: canvas.height / 2 || 250,
    highlight: false
  };
  texts.push(textObj);
  addTextControls(textObj);
  draw();
});

// Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙƒÙ„ Ù†Øµ
function addTextControls(textObj){
  const div = document.createElement('div');
  div.className = "bg-gray-700 p-3 rounded-xl space-y-2";
  div.dataset.id = textObj.id;
  div.innerHTML = `
    <input type="text" class="w-full text-black rounded p-2 text-lg" value="${textObj.text}" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§...">

    <div class="flex flex-wrap gap-3">
      <div>
        <label class="text-sm text-gray-300">ğŸ¨ Ù„ÙˆÙ† Ø§Ù„Ù†Øµ</label>
        <input type="color" value="${textObj.fillColor}" class="fillColor w-12 h-8 rounded">
      </div>
      <div>
        <label class="text-sm text-gray-300">ğŸ–‹ï¸ Ù„ÙˆÙ† Ø§Ù„Ø­Ø¯ÙˆØ¯</label>
        <input type="color" value="${textObj.strokeColor}" class="strokeColor w-12 h-8 rounded">
      </div>
      <div>
        <label class="text-sm text-gray-300">ğŸ“ Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¯ÙˆØ¯</label>
        <input type="range" min="1" max="20" value="${textObj.strokeWidth}" class="strokeWidth w-24">
      </div>
      <div>
        <label class="text-sm text-gray-300">ğŸ”  Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</label>
        <input type="range" min="20" max="150" value="${textObj.fontSize}" class="fontSize w-32">
      </div>
    </div>

    <div class="flex justify-center gap-2">
      <button class="move bg-yellow-500 px-3 py-1 rounded" data-dir="up">â¬†ï¸</button>
    </div>
    <div class="flex justify-center gap-2">
      <button class="move bg-yellow-500 px-3 py-1 rounded" data-dir="left">â¬…ï¸</button>
      <button class="move bg-yellow-500 px-3 py-1 rounded" data-dir="center">ğŸ¯</button>
      <button class="move bg-yellow-500 px-3 py-1 rounded" data-dir="right">â¡ï¸</button>
    </div>
    <div class="flex justify-center gap-2 mb-2">
      <button class="move bg-yellow-500 px-3 py-1 rounded" data-dir="down">â¬‡ï¸</button>
    </div>

    <div class="flex justify-between items-center">
      <button class="highlight bg-gray-600 px-3 py-1 rounded">${textObj.highlight ? 'âŒ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ø§ÙŠÙ„Ø§ÙŠØª' : 'ğŸ”¦ Ù‡Ø§ÙŠÙ„Ø§ÙŠØª'}</button>
      <button class="delete bg-red-500 hover:bg-red-400 px-3 py-1 rounded text-white">ğŸ—‘ï¸ Ø­Ø°Ù</button>
    </div>
  `;
  textsContainer.appendChild(div);

  // Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
  div.querySelector('input[type="text"]').addEventListener('input', e=>{
    textObj.text = e.target.value; draw();
  });
  div.querySelector('.fillColor').addEventListener('input', e=>{
    textObj.fillColor = e.target.value; draw();
  });
  div.querySelector('.strokeColor').addEventListener('input', e=>{
    textObj.strokeColor = e.target.value; draw();
  });
  div.querySelector('.strokeWidth').addEventListener('input', e=>{
    textObj.strokeWidth = parseInt(e.target.value); draw();
  });
  div.querySelector('.fontSize').addEventListener('input', e=>{
    textObj.fontSize = parseInt(e.target.value); draw();
  });

  div.querySelectorAll('.move').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const dir = btn.dataset.dir;
      if(dir==='up') textObj.y -= 10;
      if(dir==='down') textObj.y += 10;
      if(dir==='left') textObj.x -= 10;
      if(dir==='right') textObj.x += 10;
      if(dir==='center'){ textObj.x = canvas.width/2; textObj.y = canvas.height/2; }
      draw();
    });
  });

  div.querySelector('.highlight').addEventListener('click', e=>{
    textObj.highlight = !textObj.highlight;
    e.target.textContent = textObj.highlight ? 'âŒ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ø§ÙŠÙ„Ø§ÙŠØª' : 'ğŸ”¦ Ù‡Ø§ÙŠÙ„Ø§ÙŠØª';
    draw();
  });

  div.querySelector('.delete').addEventListener('click', ()=>{
    texts = texts.filter(t => t.id !== textObj.id);
    div.remove();
    draw();
  });
}

// Ø§Ù„Ø±Ø³Ù…
function draw(){
  if(!img.src) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(img,0,0,canvas.width,canvas.height);
  texts.forEach(t=>{
    ctx.font = `bold ${t.fontSize}px Tajawal`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';

    if(t.highlight){
      ctx.shadowColor = 'rgba(0,0,0,0.8)';
      ctx.shadowBlur = 15;
    } else {
      ctx.shadowBlur = 0;
    }

    ctx.lineWidth = t.strokeWidth;
    ctx.strokeStyle = t.strokeColor;
    ctx.strokeText(t.text, t.x, t.y);
    ctx.fillStyle = t.fillColor;
    ctx.fillText(t.text, t.x, t.y);
  });
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
document.getElementById('downloadBtn').onclick=()=>{
  if(!img.src) return alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹");
  const link=document.createElement('a');
  link.download='multi-text-final.png';
  link.href=canvas.toDataURL('image/png');
  link.click();
};
</script>
</body>
</html>
